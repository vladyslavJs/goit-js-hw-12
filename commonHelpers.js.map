{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["'use strict';\n\nimport axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nconst form = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.btn-load-more');\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nconst per_page = 40;\nlet page = 1;\nlet userSearch = '';\n\nform.addEventListener('submit', submitHandle);\nloadMoreBtn.addEventListener('click', handleClickMore);\n\nasync function submitHandle(event) {\n    event.preventDefault();\n    page = 1;\n    gallery.innerHTML = '';\n    userSearch = form.search.value.trim();\n\n    loadMoreBtn.classList.add('hide');\n\n    const images = await fetchImages();\n\n    if (images.hits.length === 0) {\n        iziToast.error({\n            position: 'bottomLeft',\n            message: 'Sorry, there are no images matching your search query.Please try again!',\n            color: '#37a1f2',\n            messageColor: '#FFF',\n            theme: 'dark',\n            progressBarColor: '#0047AB',\n        });\n    } else if (images.hits.length < per_page) {\n        iziToast.error({\n            position: 'bottomLeft',\n            message: 'We are sorry, but you have reached the end of search results.',\n            color: '#37a1f2',\n            messageColor: '#FFF',\n            theme: 'dark',\n            progressBarColor: '#0047AB',\n        });\n    } else {\n        loadMoreBtn.classList.remove('hide');\n    }\n\n    form.reset();\n    renderImgs(images);  \n}\n\nasync function handleClickMore() {\n    page += 1;\n\n    loadMoreBtn.classList.add('hide');\n    const images = await fetchImages();\n\n    if (page >= Math.ceil(images.totalHits / per_page)) {\n        iziToast.error({\n            position: 'bottomLeft',\n            message: 'We are sorry, but you have reached the end of search results.',\n            color: '#37a1f2',\n            messageColor: '#FFF',\n            theme: 'dark',\n            progressBarColor: '#0047AB',\n        });\n    } else {\n        loadMoreBtn.classList.remove('hide');\n    }\n    renderImgs(images);\n}\n\nasync function fetchImages() {\n    loader.classList.remove('hide');\n\n    try {\n        const images = await axios.get('https://pixabay.com/api/', {\n            params: {\n                key: '41672055-9590fca4951a86a4742f5f771',\n                q: userSearch,\n                image_type: 'photo',\n                orientation: 'horizontal',\n                safesearch: true,\n                per_page: per_page,\n                page: page,\n            },\n        });\n        return images.data;\n    } catch (error) {\n        console.log(error.message);\n        iziToast.error({\n            position: 'bottomLeft',\n            message: 'Sorry, service unavailable',\n            color: '#37a1f2',\n            messageColor: '#FFF',\n            theme: 'dark',\n            progressBarColor: '#0047AB',\n        });\n    } finally {\n        loader.classList.add('hide');\n    }\n}\n\nfunction renderImgs(images) {\n    const foundImages = images.hits.reduce(\n        (\n            html,\n            {\n                webformatURL, largeImageURL, tags, likes, views, comments, downloads, pageURL\n            }\n        ) => {\n            return (\n                html +\n                `<li class='gallery-item'>\n                        <a class='gallery-link' href='${largeImageURL}'>\n                            <img\n                                class='gallery-image'\n                                src='${webformatURL}'\n                                alt='${tags}'\n                                width='360'\n                                height='200'\n                                />\n                        </a>\n                        <p class='gallery-tags'>Get link: ${pageURL}</p>\n                        <ul class='gallery-statistic'>\n                            <li><p class='statistic'>ü©µLikes: <span>${likes}</span></p></li>\n                            <li><p class='statistic'>üëÅViews: <span>${views}</span></p></li>\n                            <li><p class='statistic'>üí¨Comments: <span>${comments}</span></p></li>\n                            <li><p class='statistic'>‚åõDownloads: <span>${downloads}</span></p></li>\n                        </ul>\n                        </li>`\n            );\n        },\n        ''\n    );\n\n    gallery.insertAdjacentHTML('beforeend', foundImages);\n    lightbox.refresh();\n}\n\n"],"names":["form","gallery","loader","loadMoreBtn","lightbox","SimpleLightbox","per_page","page","userSearch","submitHandle","handleClickMore","event","images","fetchImages","iziToast","renderImgs","axios","error","foundImages","html","webformatURL","largeImageURL","tags","likes","views","comments","downloads","pageURL"],"mappings":"owBAQA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,gBAAgB,EAErDC,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAChB,CAAC,EAEKC,EAAW,GACjB,IAAIC,EAAO,EACPC,EAAa,GAEjBR,EAAK,iBAAiB,SAAUS,CAAY,EAC5CN,EAAY,iBAAiB,QAASO,CAAe,EAErD,eAAeD,EAAaE,EAAO,CAC/BA,EAAM,eAAc,EACpBJ,EAAO,EACPN,EAAQ,UAAY,GACpBO,EAAaR,EAAK,OAAO,MAAM,KAAI,EAEnCG,EAAY,UAAU,IAAI,MAAM,EAEhC,MAAMS,EAAS,MAAMC,IAEjBD,EAAO,KAAK,SAAW,EACvBE,EAAS,MAAM,CACX,SAAU,aACV,QAAS,0EACT,MAAO,UACP,aAAc,OACd,MAAO,OACP,iBAAkB,SAC9B,CAAS,EACMF,EAAO,KAAK,OAASN,EAC5BQ,EAAS,MAAM,CACX,SAAU,aACV,QAAS,gEACT,MAAO,UACP,aAAc,OACd,MAAO,OACP,iBAAkB,SAC9B,CAAS,EAEDX,EAAY,UAAU,OAAO,MAAM,EAGvCH,EAAK,MAAK,EACVe,EAAWH,CAAM,CACrB,CAEA,eAAeF,GAAkB,CAC7BH,GAAQ,EAERJ,EAAY,UAAU,IAAI,MAAM,EAChC,MAAMS,EAAS,MAAMC,IAEjBN,GAAQ,KAAK,KAAKK,EAAO,UAAYN,CAAQ,EAC7CQ,EAAS,MAAM,CACX,SAAU,aACV,QAAS,gEACT,MAAO,UACP,aAAc,OACd,MAAO,OACP,iBAAkB,SAC9B,CAAS,EAEDX,EAAY,UAAU,OAAO,MAAM,EAEvCY,EAAWH,CAAM,CACrB,CAEA,eAAeC,GAAc,CACzBX,EAAO,UAAU,OAAO,MAAM,EAE9B,GAAI,CAYA,OAXe,MAAMc,EAAM,IAAI,2BAA4B,CACvD,OAAQ,CACJ,IAAK,qCACL,EAAGR,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUF,EACV,KAAMC,CACT,CACb,CAAS,GACa,IACjB,OAAQU,EAAP,CACE,QAAQ,IAAIA,EAAM,OAAO,EACzBH,EAAS,MAAM,CACX,SAAU,aACV,QAAS,6BACT,MAAO,UACP,aAAc,OACd,MAAO,OACP,iBAAkB,SAC9B,CAAS,CACT,QAAc,CACNZ,EAAO,UAAU,IAAI,MAAM,CAC9B,CACL,CAEA,SAASa,EAAWH,EAAQ,CACxB,MAAMM,EAAcN,EAAO,KAAK,OAC5B,CACIO,EACA,CACI,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,EAAW,QAAAC,CACzE,IAGGR,EACA;AAAA,wDACwCE;AAAA;AAAA;AAAA,uCAGjBD;AAAA,uCACAE;AAAA;AAAA;AAAA;AAAA;AAAA,4DAKqBK;AAAA;AAAA,sEAEUJ;AAAA,sEACAC;AAAA,yEACGC;AAAA,yEACAC;AAAA;AAAA,+BAKjE,EACR,EAEIzB,EAAQ,mBAAmB,YAAaiB,CAAW,EACnDd,EAAS,QAAO,CACpB"}